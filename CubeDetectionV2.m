%<//----------------------------------test case 1----------------------------------------------\\>%
    disp('test case 1')
    %1.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case1\1.1.jpg');
detect_cubes(I, 0.6, 0.7111, 0)

    %1.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case1\1.2.jpg');
detect_cubes(I, 0.6, 0.7111, 0)

    %1.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case1\1.3.jpg');
detect_cubes(I, 0.2, 0.7111, 0)

%<//----------------------------------test case 2----------------------------------------------\\>%
    disp('test case 2')
    %2.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case2\2.1.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

    %1.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case2\2.2.jpg');
detect_cubes(I, 0.6, 0.7111, 0)

    %1.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case2\2.3.jpg');
detect_cubes(I, 0.6, 0.7111, 0)

%<//----------------------------------test case 3----------------------------------------------\\>%
    disp('test case 3')
    %3.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case3\3.1.jpg');
detect_cubes(I, 0.75, 0.7111, 1)

    %3.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case3\3.2.jpg');
detect_cubes(I, 0.75, 0.7111, 0)

    %3.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case3\3.3.jpg');
detect_cubes(I, 0.6, 0.7111, 0)

%<//----------------------------------test case 4----------------------------------------------\\>%
    disp('test case 4')
    %4.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case4\4.1.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

    %4.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case4\4.2.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

    %4.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\Case4\4.3.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

%<//------------------------------------Bonus----------------------------------------------\\>%
%<//----------------------------------test case 5----------------------------------------------\\>%
    disp('test case 5')
    %5.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case5 Tilt\5.1.jpg');
%detect_cubes(I, 0.6, 0.7111, 1)

    %5.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case5 Tilt\5.1.jpg');
%detect_cubes(I, 0.6, 0.7111, 0)

%<//----------------------------------test case 6----------------------------------------------\\>%
    disp('test case 6')
    %6.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case6 ComplexBG\6.1.jpg');
detect_cubes(I, 0.2, 0.7111, 0)
    %6.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case6 ComplexBG\6.2.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

    %6.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case6 ComplexBG\6.3.jpg');
detect_cubes(I, 0.5, 0.7111, 0)

    %6.4
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case6 ComplexBG\6.4.jpg');
detect_cubes(I, 0.5, 0.7111, 0)
%<//----------------------------------test case 7----------------------------------------------\\>%
    disp('test case 7')
    %7.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case7 TightCubes\7.1.jpg');
detect_cubes(I, 0.75, 0.7111, 0)
    %7.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case7 TightCubes\7.3.jpg');
detect_cubes(I, 0.7, 0.7111, 0)
%<//----------------------------------test case 8----------------------------------------------\\>%
    disp('test case 9')
    %8.1
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\9.jpg');
detect_cubes(I, 0.2, 0.7111, 0)
    %8.2
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\C.jpg');
detect_cubes(I, 0.75, 0.7111, 0)
    %8.3
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\E.jpg');
detect_cubes(I, 0.5, 0.7111, 0)
    %8.4
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\M.jpg');
%detect_cubes(I, 0.2, 0.5, 1)
    %8.5
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\O.jpg');
detect_cubes(I, 0.2, 0.74, 0)
    %8.6
I = imread('D:\University\Study Years\4th Year\First Term\Image Processing\Labs\Lab 7- Projects  Practical problems\Projects\3 Automatic Detection and Recognition of Children Toy Cubes\TestCases\BONUS\Case8 NewShapes\Q.jpg');
detect_cubes(I, 0.2, 0.74, 0)

%confidence_value = 0.7111
%%detect_cubes(I, 0.6)    %1.1, 1.2, 2.2, 2.3, 3.3
%%detect_cubes(I, 0.2)    %1.3, 6.1, 8.1->9
%%detect_cubes(I, 0.75)   %3.2, 7.1, 3.1, 8.2->c
%%detect_cubes(I, 0.5)    %2.1, 4.1, 6.2, 6.3, 6.4 8.3->e
%%detect_cubes(I, 0.7)    %7.3

%confidence_value = 0.78
%%detect_cubes(I, 0.2)    %8.5->o







function detect_cubes(I, imbinarize_value, confidence_value, IsRotated)
    if IsRotated > 0
        I = imrotate(I, -90);
    end    
    I  = rgb2gray(I);
    %figure,imshow(I), title('after thresholding');

    BW = imbinarize(I,imbinarize_value);
    BW = medfilt2(BW,[5 5]);  %median filter 2D
    if IsRotated == 0
       BW = imcomplement(BW); % inverts the image
    end    
    

    %figure , imshow(BW), title('after median filter');

    s = regionprops(BW,'BoundingBox');
    bboxes = vertcat(s(:).BoundingBox); % concates the bounding boxes vertically 

    BW = imerode(BW,strel('disk',1));

    %figure,imshow(BW), title('after morphology');

    ocrResults = ocr(BW,bboxes,'CharacterSet','ABYT1234569CEOQ','TextLayout','Word');

    for i=1:size(ocrResults)
        txt = ocrResults(i).Text;
        conf = ocrResults(i).WordConfidences;
        if conf > confidence_value
            disp(conf);
            disp(txt);
        end
    end
end
